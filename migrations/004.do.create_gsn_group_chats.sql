CREATE TABLE group_chats (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    room_name TEXT NOT NULL UNIQUE,
    room_creator_id INTEGER REFERENCES users(id) ON DELETE CASCADE NOT NULL,
    room_description TEXT NOT NULL,
    created TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE TABLE group_users (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    room_id INTEGER REFERENCES group_chats(id) ON DELETE CASCADE NOT NULL,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE NOT NULL,
    joined TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE TABLE group_messages (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    room_id INTEGER REFERENCES group_chats(id) ON DELETE CASCADE NOT NULL,
    sent_from INTEGER REFERENCES users(id) ON DELETE CASCADE NOT NULL,
    message_body TEXT NOT NULL,
    message_sent TIMESTAMPTZ NOT NULL DEFAULT now()
);